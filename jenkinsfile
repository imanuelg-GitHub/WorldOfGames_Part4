node {
    stage('Checkout') { 
        deleteDir()
        bat ' git clone https://github.com/imanuelg-GitHub/WorldOfGames.git '
         
}
    
    stage('Build') {
        bat ' docker build -t wog-jenkinspipeline  "./app"   '
        }

    stage('Run') {
        bat' docker rm -f wog-jenkinspipeline-con '   
        bat 'docker run -dp 8777:6001 --name wog-jenkinspipeline-con --mount type=bind,source=/c:/tmp,target=/app/  wog-jenkinspipeline'

    }
    stage('Test') {
      try{
         bat  '"./app/e2e.py" '}
         
      catch(err){
           echo "an error occured"
           bat 'exit 1'
        }
      finally {
        bat  'docker rm -f wog-jenkinspipeline-con '
     
      }
      }
    

    stage('Finalize') {
         bat  'docker rm -f wog-jenkinspipeline-con '
         bat  'docker tag wog-jenkinspipeline imanuelg/wog-jenkinspipeline '
         bat  'docker push imanuelg/wog-jenkinspipeline' 
    }
}
